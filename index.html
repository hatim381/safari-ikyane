<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Safari du 1er anniversaire d’Ikyane 🦁</title>
  <link href="https://fonts.googleapis.com/css2?family=Cabin:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #fff8f1;
      --overlay: rgba(255, 248, 241, 0.88);
      --accent: #f4b56d;
      --accent-dark: #de9851;
      --jungle: #2f4b40;
      --jungle-soft: rgba(47, 75, 64, 0.07);
      --sky: #9dd7ff;
      --cloud: #ffffff;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Cabin', sans-serif;
      color: var(--jungle);
      background: var(--bg);
      background-image: radial-gradient(circle at top left, rgba(157, 215, 255, 0.35) 0, transparent 50%),
        radial-gradient(circle at bottom right, rgba(244, 181, 109, 0.25) 0, transparent 55%);
    }
    header { position: sticky; top: 0; background: rgba(255, 248, 241, 0.85); backdrop-filter: blur(8px); border-bottom: 1px solid rgba(47, 75, 64, 0.08); z-index: 50; }
    .nav { max-width: 960px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; padding: 1rem 1.5rem; }
    .badge { display: inline-flex; align-items: center; gap: 0.5rem; font-weight: 600; background: linear-gradient(120deg, var(--sky), #ffe5a3); color: #244235; padding: 0.4rem 0.9rem; border-radius: 999px; box-shadow: 0 8px 18px rgba(36, 66, 53, 0.12); }
    nav a { color: var(--jungle); text-decoration: none; font-weight: 600; padding: 0.4rem 0.8rem; border-radius: 999px; transition: all 0.2s ease; }
    nav a:hover { background: var(--jungle-soft); color: #1d3229; }
    main { padding: 2rem 1.2rem 4rem; }
    .section { max-width: 960px; margin: 0 auto 3rem; background: var(--overlay); border-radius: 24px; box-shadow: 0 12px 30px rgba(36, 66, 53, 0.08); padding: 2.4rem 2rem; position: relative; overflow: hidden; }
    .section h2 { font-family: 'Pacifico', cursive; text-align: center; margin-bottom: 1.5rem; color: #244235; }
    .upload-box { background: var(--cloud); border-radius: 18px; padding: 1.6rem; box-shadow: 0 12px 24px rgba(36, 66, 53, 0.08); display: grid; gap: 1.2rem; }
    .upload-actions { display: flex; flex-wrap: wrap; gap: 0.8rem; justify-content: center; }
    .button { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; background-color: var(--accent); color: #1d3229; padding: 0.9rem 1.6rem; border-radius: 999px; font-weight: 700; cursor: pointer; transition: transform 0.2s, background 0.2s; border: none; }
    .button:hover { background-color: var(--accent-dark); transform: translateY(-2px); }
    .file-list, .status-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 0.6rem; }
    .file-list li, .status-list li { background: rgba(36, 66, 53, 0.05); border-radius: 12px; padding: 0.75rem 1rem; font-size: 0.95rem; display: flex; justify-content: space-between; gap: 1rem; }
    .status-success { background: rgba(63, 176, 135, 0.18); color: #1d3229; }
    .status-error { background: rgba(255, 99, 71, 0.18); color: #8a1d1d; }
    footer { text-align: center; font-size: 0.95rem; color: rgba(29, 50, 41, 0.75); padding: 2rem 1rem 3rem; }
  </style>
</head>

<body>
  <header>
    <div class="nav">
      <span class="badge">🎂 1er Anniversaire Safari d’Ikyane</span>
      <nav><a href="#infos">Infos</a><a href="#souvenirs">Souvenirs</a></nav>
    </div>
  </header>

  <main>
    <section class="section" id="souvenirs">
      <h2>📸 Capture et partage tes souvenirs</h2>
      <p>Dépose tes plus jolies photos ici, elles seront ajoutées à l’album partagé pour revivre le Safari d’Ikyane !</p>

      <div class="upload-box">
        <label for="guestName" style="font-weight:600;">🪶 Ton prénom :</label>
        <input id="guestName" type="text" placeholder="Ex. Hatim" style="padding:0.6rem;border-radius:8px;border:1px solid rgba(47,75,64,0.2);font-size:1rem;width:100%;max-width:280px;margin:0 auto;display:block;" required />

        <input id="photos" type="file" accept="image/*" multiple hidden />

        <div class="upload-actions">
          <button type="button" class="button" id="select-photos">📁 Sélectionner mes fichiers</button>
          <button type="button" class="button" id="upload-photos">📤 Envoyer vers l’album</button>
        </div>

        <ul class="file-list" id="file-list"></ul>
        <ul class="status-list" id="status-list"></ul>
      </div>
    </section>
  </main>

  <footer>
    💌 Merci d’être présents pour souffler cette première bougie ! <br />
    Suis les panneaux pour rejoindre la savane 🦒
  </footer>

  <script>
    const fileInput = document.getElementById('photos');
    const selectButton = document.getElementById('select-photos');
    const uploadButton = document.getElementById('upload-photos');
    const fileList = document.getElementById('file-list');
    const statusList = document.getElementById('status-list');
    const guestName = document.getElementById('guestName');

    // ✅ Ton script Google Apps Script (Drive)
    const UPLOAD_ENDPOINT = 'https://script.google.com/macros/s/AKfycbyn9TQ2RyIVRaPyf3IpxyYrG1SVaLx1d3RQPPo60WJJBaG1GYkWsuUpoKndIBUxdRb9/exec';

    selectButton.addEventListener('click', () => fileInput.click());

    fileInput.addEventListener('change', () => {
      fileList.innerHTML = '';
      statusList.innerHTML = '';
      Array.from(fileInput.files).forEach((file) => {
        const item = document.createElement('li');
        item.textContent = `${file.name} (${(file.size / 1024).toFixed(1)} ko)`;
        fileList.appendChild(item);
      });
    });

    uploadButton.addEventListener('click', async () => {
      statusList.innerHTML = '';

      if (!guestName.value.trim()) {
        const error = document.createElement('li');
        error.textContent = '❌ Merci d’indiquer ton prénom avant l’envoi.';
        error.className = 'status-error';
        statusList.appendChild(error);
        return;
      }

      if (!fileInput.files.length) {
        const error = document.createElement('li');
        error.textContent = '❌ Sélectionne au moins une photo avant d’envoyer.';
        error.className = 'status-error';
        statusList.appendChild(error);
        return;
      }

      for (const file of fileInput.files) {
        const item = document.createElement('li');
        item.textContent = `Envoi de ${file.name}…`;
        statusList.appendChild(item);

        try {
          const formData = new FormData();
          formData.append('name', guestName.value.trim());
          formData.append(file.name, file);

          const response = await fetch(UPLOAD_ENDPOINT, {
            method: 'POST',
            body: formData,
          });

          if (!response.ok) throw new Error(`Erreur ${response.status}`);
          item.textContent = `✅ ${file.name} envoyé avec succès !`;
          item.className = 'status-success';
        } catch (err) {
          item.textContent = `❌ ${file.name} – ${err.message}`;
          item.className = 'status-error';
        }
      }

      fileInput.value = '';
      fileList.innerHTML = '';
    });
  </script>
</body>
</html>

